<!DOCTYPE html>
<!--**************************************-->
<!--* Generated from MathBook XML source *-->
<!--*    on 2017-03-27T17:08:53-07:00    *-->
<!--*                                    *-->
<!--*   http://mathbook.pugetsound.edu   *-->
<!--*                                    *-->
<!--**************************************-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Sage and Linear Algebra Worksheet</title>
<meta name="Keywords" content="Authored in MathBook XML">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/javascript" src="https://sagecell.sagemath.org/static/jquery.min.js"></script><script type="text/javascript" src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
// contrib directory for accessibility menu, moot after v2.6+?
MathJax.Ajax.config.path["Contrib"] = "https://cdn.mathjax.org/mathjax/contrib";
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']],
    },
    TeX: {
        // [Contrib]accessibility menu moot after v2.6+?
        extensions: ["AMSmath.js", "AMSsymbols.js", "extpfeil.js", "autobold.js", "https://aimath.org/mathbook/mathjaxknowl.js", "[Contrib]/a11y/accessibility-menu.js", ],
        equationNumbers: { autoNumber: "none",
                           useLabelIds: true,
                           // JS comment, XML CDATA protect XHTML quality of file
                           // if removed in XSL, use entities
                           //<![CDATA[
                           formatID: function (n) {return String(n).replace(/[:'"<>&]/g,"")},
                           //]]>
                         },
        TagSide: "right",
        TagIndent: ".8em",
    },
    "HTML-CSS": {
        scale: 88,
    },
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full"></script><script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate Sage Code'});
});
</script><link href="https://aimath.org/knowlstyle.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="https://aimath.org/knowl.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.sticky.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.espy.min.js"></script><script src="https://aimath.org/mathbook/js/Mathbook.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/stylesheets/mathbook-3.css" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/mathbook-add-on.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-article has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div style="display:none;">\(
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="CB.html"><span class="title">Sage and Linear Algebra Worksheet</span><span class="subtitle">FCLA Section CB</span></a></h1>
<p class="byline">Robert Beezer</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar" style=""><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><span class="previous-button button toolbar-item disabled">Prev</span><span class="up-button button disabled toolbar-item">Up</span><span class="next-button button toolbar-item disabled">Next</span></span></div>
<button class="sidebar-right-toggle-button button active">Annotations</button>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><span class="previous-button button toolbar-item disabled">Prev</span><span class="up-button button disabled toolbar-item">Up</span><span class="next-button button toolbar-item disabled">Next</span>
</div>
</div></nav></header><div class="page">
<aside id="sidebar-left" class="sidebar"><div class="sidebar-content">
<nav id="toc"><h2 class="link"><a href="CB.html#frontmatter-1" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a></h2>
<h2 class="link"><a href="CB.html#section-1" data-scroll="section-1"><span class="codenumber">1</span><span class="title">A Linear Transformation, Two Vector Spaces, Four Bases</span></a></h2>
<h2 class="link"><a href="CB.html#section-2" data-scroll="section-2"><span class="codenumber">2</span><span class="title">Change of Basis Matrices</span></a></h2>
<h2 class="link"><a href="CB.html#section-3" data-scroll="section-3"><span class="codenumber">3</span><span class="title">A Diagonal Representation</span></a></h2></nav><div class="extras"><nav><a class="mathbook-link" href="https://mathbook.pugetsound.edu">Authored in MathBook XML</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://cdn.mathjax.org/mathjax/badge/badge.gif" border="0" alt="Powered by MathJax"></a></nav></div>
</div></aside><main class="main"><div id="content" class="mathbook-content"><section class="article" id="CB"><section class="frontmatter" id="frontmatter-1"><h1 class="heading">
<span class="title">Sage and Linear Algebra Worksheet</span><span class="subtitle">FCLA Section CB</span>
</h1>
<address class="contributors"><p>Robert Beezer<br>Department of Mathematics and Computer Science<br>University of Puget Sound</p></address>
<address class="contributors">Spring 2017</address>
<p></p></section><section class="section" id="section-1"><header title="Section 1 A Linear Transformation, Two Vector Spaces, Four Bases"><h1 class="heading hide-type" alt="Section 1 A Linear Transformation, Two Vector Spaces, Four Bases">
<span class="type">Section</span><span class="codenumber">1</span><span class="title">A Linear Transformation, Two Vector Spaces, Four Bases</span>
</h1></header><p id="p-1">In this section we deﬁne a linear transformation from \(\mathbb{C}^{3}\) to \(\mathbb{C}^{7}\) using a randomly selected matrix. The deﬁnition is a \(7\times 3\) matrix of rank \(3\) that we will use to multiply input vectors with a matrix-vector product. It is not important if the linear transformation is injective and/or surjective.</p>
<p id="p-2">We will build two representations, using a total of four bases — two for the domain and two for the codomain.</p>
<div class="sagecell-sage" id="sage-1"><script type="text/x-sage">m, n = 7, 3
A = random_matrix(QQ, m, n, algorithm='echelonizable', rank=n, upper_bound=9)
A
</script></div>
<div class="sagecell-sage" id="sage-2"><script type="text/x-sage">T = linear_transformation(A, side='right')
T
</script></div>
<p id="p-3">The four bases, associated with the two vector spaces.</p>
<div class="sagecell-sage" id="sage-3"><script type="text/x-sage">D1mat = random_matrix(QQ, n, n, algorithm='unimodular', upper_bound=9)
D1 = D1mat.columns()
D1
VD1 = (QQ^n).subspace_with_basis(D1)
#
D2mat = random_matrix(QQ, n, n, algorithm='unimodular', upper_bound=9)
D2 = D2mat.columns()
D2
VD2 = (QQ^n).subspace_with_basis(D2)
#
C1mat = random_matrix(QQ, m, m, algorithm='unimodular', upper_bound=9)
C1 = C1mat.columns()
C1
VC1 = (QQ^m).subspace_with_basis(C1)
#
C2mat = random_matrix(QQ, m, m, algorithm='unimodular', upper_bound=9)
C2 = C2mat.columns()
C2
VC2 = (QQ^m).subspace_with_basis(C2)
</script></div>
<article class="exercise-like" id="exercise-1"><h5 class="heading">
<span class="type">Exercise</span><span class="codenumber">1</span>
</h5>
<p id="p-4">Check out a few of these bases by just asking Sage to display them.</p></article><div class="sagecell-sage" id="sage-4"><script type="text/x-sage">D1
</script></div>
<p id="p-5">Now we build two <!--Style me with CSS--><em>different</em> representations.</p>
<div class="sagecell-sage" id="sage-5"><script type="text/x-sage">rep1 = T.restrict_domain(VD1).restrict_codomain(VC1)
rep1.matrix(side='right')
</script></div>
<div class="sagecell-sage" id="sage-6"><script type="text/x-sage">rep2 = T.restrict_domain(VD2).restrict_codomain(VC2)
rep2.matrix(side='right')
</script></div></section><section class="section" id="section-2"><header title="Section 2 Change of Basis Matrices"><h1 class="heading hide-type" alt="Section 2 Change of Basis Matrices">
<span class="type">Section</span><span class="codenumber">2</span><span class="title">Change of Basis Matrices</span>
</h1></header><p id="p-6">A natural way to build a change-of-basis matrix in Sage is to adjust the bases for domain and range of the identity linear transformation by supplying an identity matrix to the linear tansformation constructor.</p>
<div class="sagecell-sage" id="sage-7"><script type="text/x-sage">identity_domain = linear_transformation(QQ^n, QQ^n, identity_matrix(n))
identity_domain
</script></div>
<div class="sagecell-sage" id="sage-8"><script type="text/x-sage">CBdom = identity_domain.restrict_domain(VD1).restrict_codomain(VD2)
CBdom_mat = CBdom.matrix(side='right')
CBdom_mat
</script></div>
<p id="p-7">This matrix should convert between the two bases for the domain.  Here's a check of Theorem CB.</p>
<div class="sagecell-sage" id="sage-9"><script type="text/x-sage">u = random_vector(QQ, n)
u1 = VD1.coordinate_vector(u)
u2 = VD2.coordinate_vector(u)
u, u1, u2, u2 == CBdom_mat*u1
</script></div>
<p id="p-8">Same drill in the codomain.</p>
<div class="sagecell-sage" id="sage-10"><script type="text/x-sage">identity_codomain = linear_transformation(QQ^m, QQ^m, identity_matrix(m))
identity_codomain
</script></div>
<div class="sagecell-sage" id="sage-11"><script type="text/x-sage">CBcodom = identity_codomain.restrict_domain(VC1).restrict_codomain(VC2)
CBcodom_mat = CBcodom.matrix(side='right')
CBcodom_mat
</script></div>
<p id="p-9">And here is the check on Theorem MRCB.  Convert from domain basis 1 to domain basis 2, use the second representation, then convert back from codomain basis 2 to codomain basis 1 and get as a result the representation relative to the first bases.</p>
<div class="sagecell-sage" id="sage-12"><script type="text/x-sage">rep1.matrix(side='right') == CBcodom_mat.inverse()*rep2.matrix(side='right')*CBdom_mat
</script></div></section><section class="section" id="section-3"><header title="Section 3 A Diagonal Representation"><h1 class="heading hide-type" alt="Section 3 A Diagonal Representation">
<span class="type">Section</span><span class="codenumber">3</span><span class="title">A Diagonal Representation</span>
</h1></header><p id="p-10">We specialize to linear transformations with equal domain and codomain.</p>
<p id="p-11">First a matrix representation using a square matrix.</p>
<div class="sagecell-sage" id="sage-13"><script type="text/x-sage">A = matrix(QQ,
[[ -2,   3, -20,  15,   1,  30,  -5,   17],
 [-27, -38, -30, -50, 268, -73, 210, -273],
 [-12, -24,  -7, -30, 142, -48, 100, -160],
 [ -3, -15,  35, -32,  35, -57,  20,  -71],
 [ -9,  -9, -10, -10,  65, -11,  50,  -59],
 [ -3,  -6, -20,   0,  58,   1,  40,  -55],
 [  3,   0,   5,   0, -10,  -3, -12,    1],
 [  0,   3,   0,   5, -19,  10, -15,   25]])
T = linear_transformation(A, side='right')
T
</script></div>
<p id="p-12">A basis of \(\mathbb{C}^8\text{.}\) And a vector space with this basis.</p>
<div class="sagecell-sage" id="sage-14"><script type="text/x-sage">v1 = vector(QQ, [-4,  -6, -1,  7, -2, -4, 1, 0])
v2 = vector(QQ, [ 3, -10, -6, -6, -2,  0, 0, 1])
v3 = vector(QQ, [ 0,  -9, -4, -1, -3, -1, 1, 0])
v4 = vector(QQ, [ 1, -12, -8, -5, -3, -2, 0, 1])
v5 = vector(QQ, [ 0,   3,  2,  2,  1,  0, 0, 0])
v6 = vector(QQ, [ 1,   0,  0, -2,  0,  1, 0, 0])
v7 = vector(QQ, [ 0,   0,  2,  3,  0,  0, 1, 0])
v8 = vector(QQ, [ 3,  -4, -2, -3,  0,  0, 0, 1])
B = [v1, v2, v3, v4, v5, v6, v7, v8]
V = (QQ^8).subspace_with_basis(B)
</script></div>
<div class="sagecell-sage" id="sage-15"><script type="text/x-sage">S = T.restrict_domain(V).restrict_codomain(V)
S.matrix(side='right')
</script></div>
<p id="p-13">That's a nice representation!  Where did the basis come from?</p>
<div class="sagecell-sage" id="sage-16"><script type="text/x-sage">A.eigenvalues()
</script></div>
<p id="p-14">Some (right) eigenvectors.</p>
<div class="sagecell-sage" id="sage-17"><script type="text/x-sage">(A - 3).right_kernel(basis='pivot').basis()
</script></div>
<p id="p-15">Eigenvalues are a property of the linear transformation.</p>
<div class="sagecell-sage" id="sage-18"><script type="text/x-sage">T.eigenvalues()
</script></div>
<p id="p-16">Bases for the eigenspaces depend on the representation, but the actual eigenvectors are also a property of the linear transformation.</p>
<div class="sagecell-sage" id="sage-19"><script type="text/x-sage">S.eigenvectors()
</script></div>
<div class="sagecell-sage" id="sage-20"><script type="text/x-sage">T.eigenvectors()
</script></div>
<p id="p-17">We could do the same thing, but in the style of Section SD, using a change-of-basis matrix.</p>
<div class="sagecell-sage" id="sage-21"><script type="text/x-sage">identity = linear_transformation(QQ^8, QQ^8, identity_matrix(8))
identity
</script></div>
<div class="sagecell-sage" id="sage-22"><script type="text/x-sage">CB = identity.restrict_domain(V).restrict_codomain(QQ^8)
CB
</script></div>
<p id="p-18">Here is similarity, in disguise.</p>
<div class="sagecell-sage" id="sage-23"><script type="text/x-sage">CBmat = CB.matrix(side='right')
CBmat.inverse()*T.matrix(side='right')*CBmat
</script></div></section></section></div></main>
</div>
</body>
</html>
