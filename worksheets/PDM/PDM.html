<!DOCTYPE html>
<!--**************************************-->
<!--* Generated from MathBook XML source *-->
<!--*    on 2017-01-31T10:10:12-08:00    *-->
<!--*                                    *-->
<!--*   http://mathbook.pugetsound.edu   *-->
<!--*                                    *-->
<!--**************************************-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Sage and Linear Algebra Worksheet</title>
<meta name="Keywords" content="Authored in MathBook XML">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/javascript" src="https://sagecell.sagemath.org/static/jquery.min.js"></script><script type="text/x-mathjax-config">
// contrib directory for accessibility menu, moot after v2.6+?
MathJax.Ajax.config.path["Contrib"] = "https://cdn.mathjax.org/mathjax/contrib";
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']],
    },
    TeX: {
        // [Contrib]accessibility menu moot after v2.6+?
        extensions: ["AMSmath.js", "AMSsymbols.js", "extpfeil.js", "autobold.js", "https://aimath.org/mathbook/mathjaxknowl.js", "[Contrib]/a11y/accessibility-menu.js", ],
        equationNumbers: { autoNumber: "none",
                           useLabelIds: true,
                           // JS comment, XML CDATA protect XHTML quality of file
                           // if removed in XSL, use entities
                           //<![CDATA[
                           formatID: function (n) {return String(n).replace(/[:'"<>&]/g,"")},
                           //]]>
                         },
        TagSide: "right",
        TagIndent: ".8em",
    },
    "HTML-CSS": {
        scale: 88,
    },
});
    </script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full"></script><script type="text/javascript" src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate Sage Code'});
});
</script><link href="https://aimath.org/knowlstyle.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="https://aimath.org/knowl.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.sticky.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.espy.min.js"></script><script src="https://aimath.org/mathbook/js/Mathbook.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/stylesheets/mathbook-3.css" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/mathbook-add-on.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-article has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div style="display:none;">\(
\newcommand{\lt}{ &lt; }
\newcommand{\gt}{ &gt; }
\newcommand{\amp}{ &amp; }
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="PDM.html"><span class="title">Sage and Linear Algebra Worksheet</span><span class="subtitle">FCLA Section PDM</span></a></h1>
<p class="byline">Robert Beezer</p>
</div>
</div></div>
<nav id="primary-navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" onclick="window.location.href='PDM.html'">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><span class="previous-button button toolbar-item disabled">Prev</span><span class="up-button button disabled toolbar-item">Up</span><span class="next-button button toolbar-item disabled">Next</span></span></div>
<button class="sidebar-right-toggle-button button active">Annotations</button>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><span class="previous-button button toolbar-item disabled">Prev</span><span class="up-button button disabled toolbar-item">Up</span><span class="next-button button toolbar-item disabled">Next</span>
</div>
</div></nav></header><div class="page">
<aside id="sidebar-left" class="sidebar"><div class="sidebar-content">
<nav id="toc"><h2 class="link"><a href="PDM.html#frontmatter-1" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a></h2>
<h2 class="link"><a href="PDM.html#section-1" data-scroll="section-1"><span class="codenumber">1</span><span class="title">LU Decomposition, Triangular Form</span></a></h2></nav><div class="extras"><nav><a class="mathbook-link" href="https://mathbook.pugetsound.edu">Authored in MathBook XML</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://cdn.mathjax.org/mathjax/badge/badge.gif" border="0" alt="Powered by MathJax"></a></nav></div>
</div></aside><main class="main"><div id="content" class="mathbook-content"><section class="article" id="PDM"><section class="frontmatter" id="frontmatter-1"><h1 class="heading">
<span class="title">Sage and Linear Algebra Worksheet</span><span class="subtitle">FCLA Section PDM</span>
</h1>
<address class="contributors"><p>Robert Beezer<br>Department of Mathematics and Computer Science<br>University of Puget Sound</p></address>
<address class="contributors">Spring 2017</address>
<p></p></section><section class="section" id="section-1"><header title="Section 1 LU Decomposition, Triangular Form"><h1 class="heading hide-type" alt="Section 1 LU Decomposition, Triangular Form">
<span class="type">Section</span><span class="codenumber">1</span><span class="title">LU Decomposition, Triangular Form</span>
</h1></header><p id="p-1">This is a topic not covered in our text.  You <!--Style me with CSS--><em>can</em> find a discussion in <span class="booktitle">A Second Course in Linear Algebra</span> at <a class="external-url" href="http://linear.ups.edu/scla/html/index.html" target="_blank"><tt class="code-inline tex2jax_ignore">http://linear.ups.edu/scla/html/index.html</tt></a>.</p>
<p id="p-2">Our goal is to row-reduce a matrix with elementary matrices, track the changes, and arrive at an expression for a square matrix \(A\) as a product of a lower-triangular matrix, \(L\), and an upper-triangular matrix, \(U\), that is \begin{equation*}A=LU\end{equation*} the so-called <em class="terminology">LU decomposition</em>.  I sometimes prefer to call it <em class="terminology">triangular form</em>.</p>
<p id="p-3">There are no exercises in this worksheet, but instead there is a careful and detailed exposition of using elementary matrices (row operations) to arrive at a <em class="terminology">matrix decomposition</em>.  There are many kinds of matrix decompositions, such as the <em class="terminology">singular value decomposition</em> (SVD), where five or six form part of the linear algebra canon.  Again, see <span class="booktitle">A Second Course in Linear Algebra</span> for details on these.</p>
<p id="p-4">We decompose a \(5\times 5\) matrix.  It is most natural to describe an LU decomposition of a square matrix, but the decomposition can be generalized to rectangular matrices.</p>
<div class="sagecell-sage" id="sage-1"><script type="text/x-sage">entries = [[-6, -10, 0, 10, 14],
[2, 3, 0, -4, -3],
[0, -2, -3, 1, 8],
[5, 6, -3, -7, -3],
[-1, 1, 6, -1, -8]]
A = matrix(QQ, entries)
A
</script></div>
<p id="p-5">Elementary matrices to “do” row operations in first column.</p>
<div class="sagecell-sage" id="sage-2"><script type="text/x-sage">actionA = elementary_matrix(QQ, 5, row1=1, row2=0, scale=-2)*elementary_matrix(QQ, 5, row1=3, row2=0, scale=-5)*elementary_matrix(QQ, 5, row1=4, row2=0, scale=1)*elementary_matrix(QQ, 5, row1=0, scale=-1/6)
B = actionA*A
B
</script></div>
<p id="p-6">Now in second column, moving to <em class="terminology">row-echelon form</em> (i.e. <!--Style me with CSS--><em>not</em> <em class="terminology">reduced row-echelon form</em>).</p>
<div class="sagecell-sage" id="sage-3"><script type="text/x-sage">actionB = elementary_matrix(QQ, 5, row1=2, row2=1, scale=2)*elementary_matrix(QQ, 5, row1=3, row2=1, scale=7/3)*elementary_matrix(QQ, 5, row1=4, row2=1, scale=-8/3)*elementary_matrix(QQ, 5, row1=1, scale=-3)
C = actionB*B
C
</script></div>
<div class="sagecell-sage" id="sage-4"><script type="text/x-sage">actionC = elementary_matrix(QQ, 5, row1=3, row2=2, scale=3)*elementary_matrix(QQ, 5, row1=4, row2=2, scale=-6)*elementary_matrix(QQ, 5, row1=2, scale=-1/3)
D = actionC*C
D
</script></div>
<p id="p-7">And now the penultimate column.</p>
<div class="sagecell-sage" id="sage-5"><script type="text/x-sage">actionD = elementary_matrix(QQ, 5, row1=4, row2=3, scale=-2)*elementary_matrix(QQ, 5, row1=3, scale=1)
E = actionD*D
E
</script></div>
<p id="p-8">And done.</p>
<div class="sagecell-sage" id="sage-6"><script type="text/x-sage">actionE = elementary_matrix(QQ, 5, row1=4, scale=1)
F = actionE*E
F
</script></div>
<p id="p-9">Clearly, <tt class="code-inline tex2jax_ignore">F</tt> has determinant 1, since it is an upper triangular matrix with diagonal entries equal to \(1\).  By tracking the effect of the above manipulations (tantamount to performing row operations) we expect that \begin{equation*}\det(A) = \left(\frac{1}{-1/6}\right)\left(\frac{1}{-3}\right)\left(\frac{1}{-1/3}\right)\left(\frac{1}{1}\right)\left(\frac{1}{1}\right)\det(F) = -6.\end{equation*} Let's check.</p>
<div class="sagecell-sage" id="sage-7"><script type="text/x-sage">A.determinant()
</script></div>
<p id="p-10">Yep.  But it gets better.  <tt class="code-inline tex2jax_ignore">F</tt> is the product of the “action” matrices on the left of <tt class="code-inline tex2jax_ignore">A</tt>.</p>
<div class="sagecell-sage" id="sage-8"><script type="text/x-sage">total_action = prod([actionE, actionD, actionC, actionB, actionA])
total_action
</script></div>
<p id="p-11">Notice that the elementary matrices we used are all lower triangular (because we just formed zeros below the diagonal of the original matrix as we brought it to row-echelon form, and there were no row swaps).  Hence their product is again lower triangular.  Now check that we have the correct matrix.</p>
<div class="sagecell-sage" id="sage-9"><script type="text/x-sage">F == total_action * A
</script></div>
<p id="p-12">The “total action” matrix is a product of elementary matrices, which are individually nonsingular.  So their product is nonsingular.  Futhermore, the inverse is again lower triangular.</p>
<div class="sagecell-sage" id="sage-10"><script type="text/x-sage">ta_inv = total_action.inverse()
ta_inv
</script></div>
<p id="p-13">We reach our goal by rearranging the equality above, writing <tt class="code-inline tex2jax_ignore">A</tt> as a product of a lower-triangular matrix with an upper-triangular matrix.</p>
<div class="sagecell-sage" id="sage-11"><script type="text/x-sage">A == ta_inv * F
</script></div>
<p id="p-14">Yes!  So we have decomposed the original matrix (<tt class="code-inline tex2jax_ignore">A</tt>) into the product of a lower triangular matrix (inverse of the total action matrix) and an upper triangular matrix with all ones on the diagonal (<tt class="code-inline tex2jax_ignore">F</tt>, the original matrix in row-echelon form).</p>
<div class="sagecell-sage" id="sage-12"><script type="text/x-sage">A, ta_inv, F
</script></div>
<p id="p-15">This decomposition (the <em class="terminology">LU decomposition</em>) can be useful for solving systems quickly.  You <em class="terminology">forward solve</em> with \(L\), then <em class="terminology">back solve</em> with \(U\).</p>
<p id="p-16">More specifically, suppose you want to solve \(A\mathbf{x}=\mathbf{b}\) for \(\mathbf{x}\), and you have a decomposition \(A=LU\).  First solve the intermediate system, \(L\mathbf{y}=\mathbf{b}\) for \(\mathbf{y}\), which can be accomplished easily by determining the entries of \(\mathbf{y}\) in order, exploiting the lower triangular nature of \(L\).  This is what is meant by the term <em class="terminology">forward solve</em>.</p>
<p id="p-17">With a solution for \(\mathbf{y}\), form the system \(U\mathbf{x}=\mathbf{y}\).  You can check that a solution, \(\mathbf{x}\), to this system is also a solution to the original system \(A\mathbf{x}=\mathbf{b}\).  Further, this solution can be found easily by determining the entries of \(\mathbf{x}\) in reverse order, exploiting the upper triangular nature of \(U\).  This is what is meant by the term <em class="terminology">back solve</em>.</p>
<p id="p-18">We solve <!--Style me with CSS--><em>two</em> simple systems, but only do half as many row-operations as if we went fully to reduced row-echelon form.  If you count the opertions carefully, you will see that this is a big win, roughly reducing computation time by a factor of half for large systems.</p></section></section></div></main>
</div>
</body>
</html>
